<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .text { font-family: Arial, sans-serif; font-size: 12px; }
      .small-text { font-family: Arial, sans-serif; font-size: 11px; }
      .hdfs-layer { fill: #e1d5e7; stroke: #9673a6; }
      .yarn-layer { fill: #fff2cc; stroke: #d6b656; }
      .client-layer { fill: #e1d5e7; stroke: #9673a6; }
      .master-node { fill: #dae8fc; stroke: #6c8ebf; }
      .worker-node { fill: #d5e8d4; stroke: #82b366; }
      .client-node { fill: #f8cecc; stroke: #b85450; }
      .protocol-hdfs { fill: #e8f5e8; stroke: #82b366; }
      .protocol-yarn { fill: #fff8e1; stroke: #d6b656; }
      .hdfs-rpc { stroke: #27ae60; stroke-width: 2; }
      .yarn-rpc { stroke: #f39c12; stroke-width: 2; }
      .client-rpc { stroke: #e74c3c; stroke-width: 2; }
      .cross-rpc { stroke: #9b59b6; stroke-width: 3; }
    </style>
  </defs>
  
  <!-- 标题 -->
  <text x="500" y="30" text-anchor="middle" class="title">Hadoop生态系统RPC通信架构</text>
  
  <!-- HDFS层 -->
  <rect x="80" y="70" width="400" height="180" rx="10" class="hdfs-layer" fill-opacity="0.3"/>
  <text x="120" y="90" class="subtitle">HDFS 分布式文件系统</text>
  
  <!-- NameNode -->
  <rect x="120" y="110" width="100" height="50" rx="5" class="master-node"/>
  <text x="170" y="140" text-anchor="middle" class="text">NameNode</text>
  
  <!-- DataNodes -->
  <rect x="120" y="180" width="80" height="40" rx="5" class="worker-node"/>
  <text x="160" y="205" text-anchor="middle" class="small-text">DataNode1</text>
  
  <rect x="220" y="180" width="80" height="40" rx="5" class="worker-node"/>
  <text x="260" y="205" text-anchor="middle" class="small-text">DataNode2</text>
  
  <rect x="320" y="180" width="80" height="40" rx="5" class="worker-node"/>
  <text x="360" y="205" text-anchor="middle" class="small-text">DataNode3</text>
  
  <!-- HDFS Client -->
  <rect x="320" y="110" width="100" height="50" rx="5" class="client-node"/>
  <text x="370" y="140" text-anchor="middle" class="text">HDFS Client</text>
  
  <!-- YARN层 -->
  <rect x="520" y="70" width="400" height="180" rx="10" class="yarn-layer" fill-opacity="0.3"/>
  <text x="560" y="90" class="subtitle">YARN 资源管理系统</text>
  
  <!-- ResourceManager -->
  <rect x="560" y="110" width="120" height="50" rx="5" class="master-node"/>
  <text x="620" y="140" text-anchor="middle" class="text">ResourceManager</text>
  
  <!-- NodeManagers -->
  <rect x="560" y="180" width="100" height="40" rx="5" class="worker-node"/>
  <text x="610" y="205" text-anchor="middle" class="small-text">NodeManager1</text>
  
  <rect x="680" y="180" width="100" height="40" rx="5" class="worker-node"/>
  <text x="730" y="205" text-anchor="middle" class="small-text">NodeManager2</text>
  
  <!-- ApplicationMaster -->
  <rect x="800" y="110" width="100" height="50" rx="5" class="client-node"/>
  <text x="850" y="140" text-anchor="middle" class="text">ApplicationMaster</text>
  
  <!-- 客户端应用层 -->
  <rect x="300" y="290" width="400" height="100" rx="10" class="client-layer" fill-opacity="0.3"/>
  <text x="340" y="310" class="subtitle">客户端应用</text>
  
  <rect x="320" y="330" width="100" height="40" rx="5" class="client-node"/>
  <text x="370" y="355" text-anchor="middle" class="small-text">MapReduce Client</text>
  
  <rect x="440" y="330" width="100" height="40" rx="5" class="client-node"/>
  <text x="490" y="355" text-anchor="middle" class="small-text">Spark Client</text>
  
  <rect x="560" y="330" width="100" height="40" rx="5" class="client-node"/>
  <text x="610" y="355" text-anchor="middle" class="small-text">Hive Client</text>
  
  <!-- RPC连接线 -->
  <!-- HDFS内部连接 -->
  <line x1="320" y1="135" x2="230" y2="135" class="hdfs-rpc"/>
  <text x="275" y="130" text-anchor="middle" class="small-text">ClientProtocol</text>
  
  <line x1="170" y1="170" x2="260" y2="170" class="hdfs-rpc"/>
  <line x1="260" y1="170" x2="360" y2="170" class="hdfs-rpc"/>
  <text x="265" y="165" text-anchor="middle" class="small-text">DatanodeProtocol</text>
  
  <!-- YARN内部连接 -->
  <line x1="800" y1="135" x2="690" y2="135" class="yarn-rpc"/>
  <text x="745" y="130" text-anchor="middle" class="small-text">ApplicationMasterProtocol</text>
  
  <path d="M 850 170 Q 800 180 610 180" stroke="#f39c12" stroke-width="2" fill="none"/>
  <path d="M 850 170 Q 800 180 730 180" stroke="#f39c12" stroke-width="2" fill="none"/>
  <text x="740" y="165" text-anchor="middle" class="small-text">ContainerManagementProtocol</text>
  
  <!-- 客户端到服务的连接 -->
  <line x1="370" y1="290" x2="170" y2="250" class="client-rpc"/>
  <text x="250" y="265" text-anchor="middle" class="small-text">ClientProtocol</text>
  
  <line x1="490" y1="290" x2="620" y2="250" class="client-rpc"/>
  <text x="570" y="265" text-anchor="middle" class="small-text">ApplicationClientProtocol</text>
  
  <!-- 跨系统连接 -->
  <line x1="480" y1="160" x2="520" y2="160" class="cross-rpc"/>
  <text x="500" y="155" text-anchor="middle" class="text">跨系统RPC调用</text>
  
  <!-- RPC协议标注 -->
  <text x="120" y="430" class="subtitle">主要RPC协议</text>
  
  <rect x="80" y="450" width="100" height="30" rx="5" class="protocol-hdfs"/>
  <text x="130" y="470" text-anchor="middle" class="small-text">ClientProtocol</text>
  
  <rect x="200" y="450" width="120" height="30" rx="5" class="protocol-hdfs"/>
  <text x="260" y="470" text-anchor="middle" class="small-text">DatanodeProtocol</text>
  
  <rect x="340" y="450" width="150" height="30" rx="5" class="protocol-yarn"/>
  <text x="415" y="470" text-anchor="middle" class="small-text">ApplicationClientProtocol</text>
  
  <rect x="510" y="450" width="160" height="30" rx="5" class="protocol-yarn"/>
  <text x="590" y="470" text-anchor="middle" class="small-text">ApplicationMasterProtocol</text>
  
  <rect x="690" y="450" width="180" height="30" rx="5" class="protocol-yarn"/>
  <text x="780" y="470" text-anchor="middle" class="small-text">ContainerManagementProtocol</text>
  
  <!-- 图例 -->
  <text x="80" y="520" class="subtitle">图例</text>
  
  <rect x="80" y="540" width="80" height="30" rx="5" class="master-node"/>
  <text x="120" y="560" text-anchor="middle" class="small-text">主节点</text>
  
  <rect x="180" y="540" width="80" height="30" rx="5" class="worker-node"/>
  <text x="220" y="560" text-anchor="middle" class="small-text">工作节点</text>
  
  <rect x="280" y="540" width="80" height="30" rx="5" class="client-node"/>
  <text x="320" y="560" text-anchor="middle" class="small-text">客户端</text>
  
  <line x1="400" y1="555" x2="450" y2="555" class="hdfs-rpc"/>
  <text x="480" y="560" class="small-text">HDFS RPC</text>
  
  <line x1="550" y1="555" x2="600" y2="555" class="yarn-rpc"/>
  <text x="630" y="560" class="small-text">YARN RPC</text>
  
  <line x1="700" y1="555" x2="750" y2="555" class="client-rpc"/>
  <text x="780" y="560" class="small-text">客户端RPC</text>
  
</svg>
