<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="1000" viewBox="0 0 1400 1000">
  <!-- 背景 -->
  <rect width="1400" height="1000" fill="#ffffff"/>
  
  <!-- 标题 -->
  <text x="700" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#2c3e50">
    Hadoop RPC三代序列化引擎架构对比
  </text>
  
  <!-- WritableRpcEngine (第一代) -->
  <rect x="50" y="80" width="400" height="750" rx="10" fill="#ffebee" stroke="#e74c3c" stroke-width="2"/>
  <text x="250" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    WritableRpcEngine (第一代)
  </text>
  
  <!-- 第一代客户端架构 -->
  <rect x="70" y="120" width="360" height="200" rx="5" fill="#fdeaea" stroke="#e74c3c"/>
  <text x="250" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    客户端架构
  </text>
  
  <rect x="90" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="150" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">动态代理 (Proxy)</text>
  
  <rect x="230" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="290" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">WritableRpcInvoker</text>
  
  <rect x="90" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="150" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Invocation对象</text>
  
  <rect x="230" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="290" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Client连接管理</text>
  
  <rect x="160" y="270" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="220" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">序列化层</text>
  
  <!-- 第一代服务端架构 -->
  <rect x="70" y="340" width="360" height="200" rx="5" fill="#fdeaea" stroke="#e74c3c"/>
  <text x="250" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    服务端架构
  </text>
  
  <rect x="90" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="160" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">WritableRpcEngine.Server</text>
  
  <rect x="250" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="320" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">WritableRpcInvoker</text>
  
  <rect x="90" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="160" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">反射调用机制</text>
  
  <rect x="250" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="320" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">ObjectWritable返回</text>
  
  <rect x="170" y="490" width="120" height="40" rx="5" fill="#ffffff" stroke="#e74c3c"/>
  <text x="230" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">反序列化层</text>
  
  <!-- 第一代特点 -->
  <rect x="70" y="560" width="360" height="200" rx="5" fill="#fdeaea" stroke="#e74c3c"/>
  <text x="250" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    技术特点
  </text>
  
  <text x="90" y="610" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ Java原生Writable接口</text>
  <text x="90" y="630" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 简单直接的设计</text>
  <text x="90" y="650" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 与Hadoop生态集成</text>
  <text x="90" y="690" font-family="Arial, sans-serif" font-size="11" fill="#e74c3c">✗ 性能相对较低</text>
  <text x="90" y="710" font-family="Arial, sans-serif" font-size="11" fill="#e74c3c">✗ 反射调用开销大</text>
  <text x="90" y="730" font-family="Arial, sans-serif" font-size="11" fill="#e74c3c">✗ 缺乏跨语言支持</text>
  
  <rect x="90" y="770" width="100" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="140" y="790" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e74c3c">状态：已废弃</text>
  
  <!-- ProtobufRpcEngine (第二代) -->
  <rect x="500" y="80" width="400" height="750" rx="10" fill="#fef9e7" stroke="#f39c12" stroke-width="2"/>
  <text x="700" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    ProtobufRpcEngine (第二代)
  </text>
  
  <!-- 第二代客户端架构 -->
  <rect x="520" y="120" width="360" height="200" rx="5" fill="#fdf6e3" stroke="#f39c12"/>
  <text x="700" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    客户端架构
  </text>
  
  <rect x="540" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="600" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">动态代理 (Proxy)</text>
  
  <rect x="680" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="740" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">ProtobufRpcInvoker</text>
  
  <rect x="540" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="600" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">RequestHeaderProto</text>
  
  <rect x="680" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="740" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Client连接管理</text>
  
  <rect x="610" y="270" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="670" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Protobuf序列化</text>
  
  <!-- 第二代服务端架构 -->
  <rect x="520" y="340" width="360" height="200" rx="5" fill="#fdf6e3" stroke="#f39c12"/>
  <text x="700" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    服务端架构
  </text>
  
  <rect x="540" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="610" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">ProtobufRpcEngine.Server</text>
  
  <rect x="700" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="770" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">BlockingService</text>
  
  <rect x="540" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="610" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">RpcProtobufRequest</text>
  
  <rect x="700" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="770" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Protobuf Message</text>
  
  <rect x="620" y="490" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12"/>
  <text x="680" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Protobuf反序列化</text>
  
  <!-- 第二代特点 -->
  <rect x="520" y="560" width="360" height="200" rx="5" fill="#fdf6e3" stroke="#f39c12"/>
  <text x="700" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    技术特点
  </text>
  
  <text x="540" y="610" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ Protocol Buffers 2.5支持</text>
  <text x="540" y="630" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 显著性能提升</text>
  <text x="540" y="650" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 初步跨语言支持</text>
  <text x="540" y="670" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 向后兼容设计</text>
  <text x="540" y="710" font-family="Arial, sans-serif" font-size="11" fill="#e74c3c">✗ 依赖特定protobuf版本</text>
  <text x="540" y="730" font-family="Arial, sans-serif" font-size="11" fill="#e74c3c">✗ 缺乏异步支持</text>
  
  <rect x="540" y="770" width="100" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="590" y="790" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#f39c12">状态：过渡期</text>
  
  <!-- ProtobufRpcEngine2 (第三代) -->
  <rect x="950" y="80" width="400" height="750" rx="10" fill="#eafaf1" stroke="#27ae60" stroke-width="2"/>
  <text x="1150" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    ProtobufRpcEngine2 (第三代)
  </text>
  
  <!-- 第三代客户端架构 -->
  <rect x="970" y="120" width="360" height="200" rx="5" fill="#e8f5e8" stroke="#27ae60"/>
  <text x="1150" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    客户端架构
  </text>
  
  <rect x="990" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1050" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">动态代理 (Proxy)</text>
  
  <rect x="1130" y="150" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1190" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">ProtobufRpcInvoker2</text>
  
  <rect x="990" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1050" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">AsyncGet支持</text>
  
  <rect x="1130" y="210" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1190" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">CompletableFuture</text>
  
  <rect x="1060" y="270" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1120" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">阴影Protobuf序列化</text>
  
  <!-- 第三代服务端架构 -->
  <rect x="970" y="340" width="360" height="200" rx="5" fill="#e8f5e8" stroke="#27ae60"/>
  <text x="1150" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    服务端架构
  </text>
  
  <rect x="990" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1060" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">ProtobufRpcEngine2.Server</text>
  
  <rect x="1150" y="370" width="140" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1220" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">BlockingService</text>
  
  <rect x="990" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1060" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">RpcProtobufRequest</text>
  
  <rect x="1150" y="430" width="140" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1220" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">RpcWritable.Buffer</text>
  
  <rect x="1070" y="490" width="120" height="40" rx="5" fill="#ffffff" stroke="#27ae60"/>
  <text x="1130" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">阴影Protobuf反序列化</text>
  
  <!-- 第三代特点 -->
  <rect x="970" y="560" width="360" height="200" rx="5" fill="#e8f5e8" stroke="#27ae60"/>
  <text x="1150" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    技术特点
  </text>
  
  <text x="990" y="610" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ Protocol Buffers 3.x全面支持</text>
  <text x="990" y="630" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 阴影类库避免冲突</text>
  <text x="990" y="650" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 异步RPC支持</text>
  <text x="990" y="670" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 最佳性能表现</text>
  <text x="990" y="690" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 完整跨语言生态</text>
  <text x="990" y="710" font-family="Arial, sans-serif" font-size="11" fill="#27ae60">✓ 企业级特性完善</text>
  
  <rect x="990" y="770" width="120" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="1050" y="790" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#27ae60">状态：当前推荐</text>
  
  <!-- 演进箭头 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498db"/>
    </marker>
  </defs>
  
  <path d="M 450 450 Q 475 430 500 450" stroke="#3498db" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
  <text x="475" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3498db">
    <tspan x="475" dy="0">性能需求</tspan>
    <tspan x="475" dy="12">标准化</tspan>
  </text>
  
  <path d="M 900 450 Q 925 430 950 450" stroke="#3498db" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
  <text x="925" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#3498db">
    <tspan x="925" dy="0">现代化</tspan>
    <tspan x="925" dy="12">异步支持</tspan>
  </text>
  
  <!-- 性能对比表格 -->
  <rect x="50" y="850" width="1300" height="120" rx="10" fill="#f8f9fa" stroke="#6c757d" stroke-width="2"/>
  <text x="700" y="875" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
    性能对比指标
  </text>
  
  <!-- 表格头部 -->
  <rect x="70" y="880" width="100" height="30" rx="5" fill="#e9ecef" stroke="#6c757d"/>
  <text x="120" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">序列化速度</text>
  
  <rect x="180" y="880" width="80" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="220" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">较慢</text>
  
  <rect x="270" y="880" width="80" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="310" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">中等</text>
  
  <rect x="360" y="880" width="80" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="400" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">最快</text>
  
  <rect x="460" y="880" width="100" height="30" rx="5" fill="#e9ecef" stroke="#6c757d"/>
  <text x="510" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">消息大小</text>
  
  <rect x="570" y="880" width="80" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="610" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">较大</text>
  
  <rect x="660" y="880" width="80" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="700" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">中等</text>
  
  <rect x="750" y="880" width="80" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="790" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">最小</text>
  
  <rect x="850" y="880" width="100" height="30" rx="5" fill="#e9ecef" stroke="#6c757d"/>
  <text x="900" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">跨语言支持</text>
  
  <rect x="960" y="880" width="80" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="1000" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">无</text>
  
  <rect x="1050" y="880" width="80" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="1090" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">部分</text>
  
  <rect x="1140" y="880" width="80" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="1180" y="900" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">完整</text>
  
  <!-- 第二行 -->
  <rect x="70" y="920" width="100" height="30" rx="5" fill="#e9ecef" stroke="#6c757d"/>
  <text x="120" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">异步支持</text>
  
  <rect x="180" y="920" width="80" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="220" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">无</text>
  
  <rect x="270" y="920" width="80" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="310" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">无</text>
  
  <rect x="360" y="920" width="80" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="400" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">完整</text>
  
  <rect x="460" y="920" width="100" height="30" rx="5" fill="#e9ecef" stroke="#6c757d"/>
  <text x="510" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">维护状态</text>
  
  <rect x="570" y="920" width="80" height="30" rx="5" fill="#ffebee" stroke="#e74c3c"/>
  <text x="610" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">已废弃</text>
  
  <rect x="660" y="920" width="80" height="30" rx="5" fill="#fef9e7" stroke="#f39c12"/>
  <text x="700" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">过渡期</text>
  
  <rect x="750" y="920" width="80" height="30" rx="5" fill="#eafaf1" stroke="#27ae60"/>
  <text x="790" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">推荐</text>
</svg>
