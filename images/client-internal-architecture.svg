<?xml version="1.0" encoding="UTF-8"?>
<svg width="1100" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .text { font-family: Arial, sans-serif; font-size: 12px; }
      .small-text { font-family: Arial, sans-serif; font-size: 11px; }
      .client-main { fill: #dae8fc; stroke: #6c8ebf; fill-opacity: 0.3; }
      .core-methods { fill: #e8f4fd; stroke: #6c8ebf; }
      .method-box { fill: #f0f8ff; stroke: #6c8ebf; }
      .call-inner { fill: #d5e8d4; stroke: #82b366; }
      .call-attr { fill: #e8f5e8; stroke: #82b366; }
      .connection-inner { fill: #fff2cc; stroke: #d6b656; }
      .conn-attrs { fill: #fff8e1; stroke: #d6b656; }
      .conn-item { fill: #fffacd; stroke: #d6b656; }
      .connection-pool { fill: #f8cecc; stroke: #b85450; }
      .pool-item { fill: #fce4ec; stroke: #b85450; }
      .external-comp { fill: #e1d5e7; stroke: #9673a6; }
      .async-comp { fill: #d5e8d4; stroke: #82b366; }
      .async-item { fill: #e8f5e8; stroke: #82b366; }
    </style>
  </defs>
  
  <!-- æ ‡é¢˜ -->
  <text x="550" y="30" text-anchor="middle" class="title">Clientç±»å†…éƒ¨æ¶æ„è®¾è®¡</text>
  
  <!-- Clientä¸»ç±» -->
  <rect x="400" y="80" width="400" height="500" rx="10" class="client-main"/>
  <text x="600" y="100" text-anchor="middle" class="subtitle" fill="#6c8ebf">Clientç±»</text>
  
  <!-- æ ¸å¿ƒæ–¹æ³•åŒºåŸŸ -->
  <rect x="420" y="120" width="160" height="120" rx="5" class="core-methods"/>
  <text x="500" y="140" text-anchor="middle" class="subtitle" fill="#6c8ebf">æ ¸å¿ƒæ–¹æ³•</text>
  
  <rect x="430" y="150" width="60" height="25" rx="3" class="method-box"/>
  <text x="460" y="167" text-anchor="middle" class="small-text">call()</text>
  
  <rect x="500" y="150" width="70" height="25" rx="3" class="method-box"/>
  <text x="535" y="167" text-anchor="middle" class="small-text">sendRpcRequest()</text>
  
  <rect x="430" y="185" width="80" height="25" rx="3" class="method-box"/>
  <text x="470" y="202" text-anchor="middle" class="small-text">receiveRpcResponse()</text>
  
  <rect x="520" y="185" width="70" height="25" rx="3" class="method-box"/>
  <text x="555" y="202" text-anchor="middle" class="small-text">getConnection()</text>
  
  <rect x="480" y="220" width="50" height="25" rx="3" class="method-box"/>
  <text x="505" y="237" text-anchor="middle" class="small-text">stop()</text>
  
  <!-- Callå†…éƒ¨ç±» -->
  <rect x="620" y="120" width="160" height="120" rx="5" class="call-inner"/>
  <text x="700" y="140" text-anchor="middle" class="subtitle" fill="#82b366">Callå†…éƒ¨ç±»</text>
  
  <rect x="630" y="150" width="70" height="20" rx="3" class="call-attr"/>
  <text x="665" y="163" text-anchor="middle" class="small-text">callId: int</text>
  
  <rect x="710" y="150" width="60" height="20" rx="3" class="call-attr"/>
  <text x="740" y="163" text-anchor="middle" class="small-text">retry: int</text>
  
  <rect x="630" y="180" width="70" height="20" rx="3" class="call-attr"/>
  <text x="665" y="193" text-anchor="middle" class="small-text">rpcRequest</text>
  
  <rect x="710" y="180" width="60" height="20" rx="3" class="call-attr"/>
  <text x="740" y="193" text-anchor="middle" class="small-text">CompletableFuture</text>
  
  <rect x="670" y="210" width="60" height="20" rx="3" class="call-attr"/>
  <text x="700" y="223" text-anchor="middle" class="small-text">timestamp</text>
  
  <!-- Connectionå†…éƒ¨ç±» -->
  <rect x="420" y="270" width="360" height="180" rx="5" class="connection-inner"/>
  <text x="600" y="290" text-anchor="middle" class="subtitle" fill="#d6b656">Connectionå†…éƒ¨ç±»</text>
  
  <!-- Connectionå±æ€§åŒºåŸŸ -->
  <rect x="430" y="300" width="160" height="80" rx="5" class="conn-attrs"/>
  <text x="510" y="320" text-anchor="middle" class="text" fill="#d6b656">è¿æ¥å±æ€§</text>
  
  <rect x="440" y="330" width="60" height="20" rx="3" class="conn-item"/>
  <text x="470" y="343" text-anchor="middle" class="small-text">ConnectionId</text>
  
  <rect x="510" y="330" width="50" height="20" rx="3" class="conn-item"/>
  <text x="535" y="343" text-anchor="middle" class="small-text">Socket</text>
  
  <rect x="440" y="360" width="60" height="20" rx="3" class="conn-item"/>
  <text x="470" y="373" text-anchor="middle" class="small-text">InputStream</text>
  
  <rect x="510" y="360" width="70" height="20" rx="3" class="conn-item"/>
  <text x="545" y="373" text-anchor="middle" class="small-text">OutputStream</text>
  
  <!-- Connectionæ–¹æ³•åŒºåŸŸ -->
  <rect x="610" y="300" width="160" height="80" rx="5" class="conn-attrs"/>
  <text x="690" y="320" text-anchor="middle" class="text" fill="#d6b656">è¿æ¥æ–¹æ³•</text>
  
  <rect x="620" y="330" width="80" height="20" rx="3" class="conn-item"/>
  <text x="660" y="343" text-anchor="middle" class="small-text">setupConnection()</text>
  
  <rect x="710" y="330" width="50" height="20" rx="3" class="conn-item"/>
  <text x="735" y="343" text-anchor="middle" class="small-text">sendRpcRequest()</text>
  
  <rect x="620" y="360" width="80" height="20" rx="3" class="conn-item"/>
  <text x="660" y="373" text-anchor="middle" class="small-text">receiveRpcResponse()</text>
  
  <rect x="710" y="360" width="40" height="20" rx="3" class="conn-item"/>
  <text x="730" y="373" text-anchor="middle" class="small-text">close()</text>
  
  <!-- ConnectionçŠ¶æ€ç®¡ç† -->
  <rect x="430" y="390" width="340" height="50" rx="5" class="conn-attrs"/>
  <text x="600" y="410" text-anchor="middle" class="text" fill="#d6b656">çŠ¶æ€ç®¡ç†</text>
  
  <rect x="440" y="420" width="120" height="20" rx="3" class="conn-item"/>
  <text x="500" y="433" text-anchor="middle" class="small-text">calls: Map&lt;Integer, Call&gt;</text>
  
  <rect x="570" y="420" width="100" height="20" rx="3" class="conn-item"/>
  <text x="620" y="433" text-anchor="middle" class="small-text">shouldCloseConnection</text>
  
  <rect x="680" y="420" width="80" height="20" rx="3" class="conn-item"/>
  <text x="720" y="433" text-anchor="middle" class="small-text">lastActivity</text>
  
  <!-- è¿æ¥æ± ç®¡ç† -->
  <rect x="420" y="480" width="360" height="80" rx="5" class="connection-pool"/>
  <text x="600" y="500" text-anchor="middle" class="subtitle" fill="#b85450">è¿æ¥æ± ç®¡ç†</text>
  
  <rect x="430" y="510" width="200" height="25" rx="3" class="pool-item"/>
  <text x="530" y="527" text-anchor="middle" class="small-text">connections: Map&lt;ConnectionId, Connection&gt;</text>
  
  <rect x="650" y="510" width="100" height="25" rx="3" class="pool-item"/>
  <text x="700" y="527" text-anchor="middle" class="small-text">ConnectionFactory</text>
  
  <rect x="540" y="540" width="80" height="25" rx="3" class="pool-item"/>
  <text x="580" y="557" text-anchor="middle" class="small-text">è¿æ¥æ¸…ç†æœºåˆ¶</text>
  
  <!-- å¤–éƒ¨ç»„ä»¶ -->
  <rect x="100" y="200" width="80" height="40" rx="5" class="external-comp"/>
  <text x="140" y="225" text-anchor="middle" class="text">RpcEngine</text>
  
  <rect x="100" y="280" width="80" height="40" rx="5" class="external-comp"/>
  <text x="140" y="305" text-anchor="middle" class="text">Configuration</text>
  
  <rect x="100" y="360" width="80" height="40" rx="5" class="external-comp"/>
  <text x="140" y="385" text-anchor="middle" class="text">SaslRpcClient</text>
  
  <!-- å¼‚æ­¥å¤„ç† -->
  <rect x="850" y="200" width="200" height="150" rx="5" class="async-comp"/>
  <text x="950" y="220" text-anchor="middle" class="subtitle" fill="#82b366">å¼‚æ­¥å¤„ç†æœºåˆ¶</text>
  
  <rect x="870" y="230" width="120" height="25" rx="3" class="async-item"/>
  <text x="930" y="247" text-anchor="middle" class="small-text">CompletableFuture&lt;T&gt;</text>
  
  <rect x="870" y="265" width="100" height="25" rx="3" class="async-item"/>
  <text x="920" y="282" text-anchor="middle" class="small-text">AsyncCallback</text>
  
  <rect x="870" y="300" width="100" height="25" rx="3" class="async-item"/>
  <text x="920" y="317" text-anchor="middle" class="small-text">ExecutorService</text>
  
  <rect x="870" y="335" width="100" height="25" rx="3" class="async-item"/>
  <text x="920" y="352" text-anchor="middle" class="small-text">è¶…æ—¶å¤„ç†æœºåˆ¶</text>
  
  <!-- è¿æ¥çº¿ -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <marker id="arrowhead-use" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60"/>
    </marker>
    <marker id="arrowhead-create" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/>
    </marker>
  </defs>
  
  <!-- å¤–éƒ¨ä¾èµ–è¿æ¥ -->
  <line x1="180" y1="220" x2="400" y2="180" stroke="#27ae60" stroke-width="2" marker-end="url(#arrowhead-use)"/>
  <line x1="180" y1="300" x2="400" y2="250" stroke="#27ae60" stroke-width="2" marker-end="url(#arrowhead-use)"/>
  <line x1="180" y1="380" x2="400" y2="350" stroke="#27ae60" stroke-width="2" marker-end="url(#arrowhead-use)"/>
  
  <!-- Clientåˆ°Callçš„åˆ›å»ºå…³ç³» -->
  <line x1="580" y1="180" x2="620" y2="180" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowhead-create)"/>
  <text x="590" y="175" fill="#e74c3c" class="small-text">åˆ›å»º</text>
  
  <!-- Clientåˆ°å¼‚æ­¥å¤„ç†çš„ä½¿ç”¨å…³ç³» -->
  <line x1="800" y1="200" x2="850" y2="250" stroke="#27ae60" stroke-width="2" marker-end="url(#arrowhead-use)"/>
  <text x="810" y="220" fill="#27ae60" class="small-text">å¼‚æ­¥è°ƒç”¨</text>
  
  <!-- è°ƒç”¨æµç¨‹è¯´æ˜ -->
  <text x="50" y="650" class="subtitle" fill="#2c3e50">è°ƒç”¨æµç¨‹ï¼š</text>
  <text x="50" y="670" class="small-text" fill="#2c3e50">1. call() â†’ 2. getConnection() â†’ 3. sendRpcRequest() â†’ 4. receiveRpcResponse()</text>
  
  <!-- ç»„ä»¶è¯´æ˜ -->
  <text x="850" y="400" class="text" fill="#2c3e50">ğŸ”µ ä¸»è¦æ–¹æ³•</text>
  <text x="850" y="420" class="text" fill="#2c3e50">ğŸŸ¢ å†…éƒ¨ç±»</text>
  <text x="850" y="440" class="text" fill="#2c3e50">ğŸŸ¡ è¿æ¥ç®¡ç†</text>
  <text x="850" y="460" class="text" fill="#2c3e50">ğŸ”´ è¿æ¥æ± </text>
  <text x="850" y="480" class="text" fill="#2c3e50">ğŸŸ£ å¤–éƒ¨ä¾èµ–</text>
  
</svg>
